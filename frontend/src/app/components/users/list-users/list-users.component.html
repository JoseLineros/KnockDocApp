<app-container-sidebar></app-container-sidebar>

<div class="container-fluid mt-1">
  <h5 class="color-titles mb-3">Administración de usuarios</h5>
  <div class="row">
    <div class="col-12 col-md-4 col-lg-4 px-0">
      <div class="card">
        <div class="card-header bg-blue text-light">
          <h6 class="mb-0">Editar Usuario</h6>
        </div>
        <div class="card-body cardOverflow">
          <form #createForm="ngForm">
            <div class="form-group">
							<input
								#name="ngModel"
								[(ngModel)]="userService.selectedUser._id"
								type="hidden"
								id="_id"
								name="_id"
							/>
						</div>
            <div class="form-group">
              <label for="identificacion" class="text-muted"> <small> Identificacion </small></label>
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.identificacion"
                type="text"
                class="form-control bg-light"
                id="identificacion"
                name="identificacion"
                aria-describedby="identificacion"
                placeholder="Ingrese su identificacion"
                required
                autofocus
              />
            </div>

            <div class="form-group">
              <label for="nombre" class="text-muted"> <small>Nombre</small></label>
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.nombre"
                type="text"
                class="form-control bg-light"
                id="nombre"
                name="nombre"
                aria-describedby="nombre"
                placeholder="Ingrese su nombre"
                required
              />
            </div>

            <div class="form-group">
              <label for="apellidos" class="text-muted"> <small>Apellidos</small></label>
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.apellidos"
                class="form-control bg-light"
                id="apellidos"
                name="apellidos"
                aria-describedby="apellidos"
                placeholder="Ingrese sus apellidos"
                required
              />
            </div>

            <div class="form-group">
              <label for="fechaNacimiento" class="text-muted"> <small> FechaNacimiento</small></label>
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.fechaNacimiento"
                type="date"
                class="form-control bg-light"
                id="fechaNacimiento"
                name="fechaNacimiento"
                aria-describedby="fechaNacimiento"
                placeholder="Seleccione su fecha de nacimiento"
                required
              />
            </div>

            <div class="form-group">
              <label for="ciudad" class="text-muted"> <small> Ciudad</small></label>
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.ciudad"
                type="text"
                class="form-control bg-light"
                id="ciudad"
                name="ciudad"
                aria-describedby="ciudad"
                placeholder="Ingrese su ciudad"
                required
              />
            </div>

            <div class="form-group">
              <label for="direccion" class="text-muted"> <small> Dirección </small></label>
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.direccion"
                type="text"
                class="form-control bg-light"
                id="direccion"
                name="direccion"
                aria-describedby="direccion"
                placeholder="Ingrese su direccion"
                required
              />
            </div>

            <div class="form-group">
              <label for="celular" class="text-muted"> <small> Celular </small></label>
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.celular"
                type="text"
                class="form-control bg-light"
                id="celular"
                name="celular"
                aria-describedby="celular"
                placeholder="Ingrese su celular"
                required
              />
            </div>

            <div class="form-group">
              <label for="ipsAsociado" class="text-muted">
                <small> IPS Asociado </small></label
              >
              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.ipsAsociado"
                type="hidden"
                class="form-control bg-light"
                id="ipsAsociado"
                name="ipsAsociado"
                aria-describedby="ipsAsociado"
                placeholder="Ingrese ips asociado"
                readonly
              />
              <select
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.ipsAsociado"
                class="form-control"
                id="ipsAsociado"
                name="ipsAsociado"
                aria-describedby="ipsAsociado"
                placeholder="Ingrese IPS Asociado"
                required
              >
                <option value="">Seleccione Opcion</option>
                <option
                  *ngFor="let ips of this.ipsService.ips"
                  value="{{ ips.identificacion }}"
                >
                  {{ ips.razonSocial }}
                </option>
              </select>
            </div>



            <div class="form-group">
              <label for="email" class="text-muted">
                <small>Email</small></label
              >

              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.email"
                type="text"
                class="form-control bg-light"
                id="email"
                name="email"
                aria-describedby="email"
                placeholder="Email"
                required
              />
            </div>

            <div class="form-group">
              <label for="password" class="text-muted">
                <small>Password</small></label
              >

              <input
                #name="ngModel"
                [(ngModel)]="userService.selectedUser.password"
                type="password"
                class="form-control bg-light"
                id="password"
                name="password"
                aria-describedby="password"
                placeholder="Password"
                required
              />
            </div>

            <div class="form-group">
              <input
                #name="ngModel"
                [(ngModel)]="role"
                type="hidden"
                class="form-control bg-light"
                id="role"
                name="role"
                aria-describedby="role"
                required
              />
            </div>

            <button class="btn btn-success me-2 btn-block" (click)="save(createForm)">
              Guardar
            </button>

            <button class="btn btn-dark btn-block" (click)="clean(createForm)">
              Limpiar
            </button>
          </form>
        </div>
      </div>
    </div>

    <div class="col-12 col-md-7 col-lg-8 pr-0">

      <div class="card">
        <div class="card-header bg-dark text-light">
          <h6 class="mb-0">Listado de usuarios</h6>
        </div>
        <div class="card-body p-0">
          <div class="table-responsive font-13">
            <table class="table text-center mt-0">
              <thead class="bg-light color-blue">
                <tr>
                  <th scope="col">Identificacion</th>
                  <th scope="col">Nombre</th>
                  <th scope="col">Apellidos</th>
                  <th scope="col">Acciones</th>
                </tr>
              </thead>
              <tbody>
                <div *ngIf="loading" class="d-flex justify-content-center">
                  <div class="spinner-border" role="status">
                    <span class="visually-hidden"></span>
                  </div>
                </div>
                <tr *ngFor="let user of userService.users">
                  <td class="pt-3">{{ user.identificacion }}</td>
                  <td class="pt-3">{{ user.nombre }}</td>
                  <td class="pt-3">{{ user.apellidos }}</td>
                  <td>
                    <button class="btn btn-light mr-2 btn-sm rounded-circle pt-1" (click)="fillFields(user)"><i class="bi bi-pencil-fill color-blue"></i></button>
                    <button class="btn btn-light btn-sm rounded-circle pt-1" (click)="deleteUser(user._id)"><i class="bi bi-trash-fill text-danger"></i></button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
